<!DOCTYPE html>
<html>
<head>
    <link rel="stylesheet" href="css/style.css" />
	<!-- include jQuery library -->
	<script src="http://code.jquery.com/jquery-1.8.1.min.js"></script>
	<script>
	
		
		/*
		//example
		$(document).ready(function()(
		
		//words//
		$("body").append("testing");
		
		//popup//
		$("#get").on("click", function()(
			console.log("you clicked on me");
			));
			
		$("body").append("<h2>Does this fire?<h2>");
		*/
		
		// This is the scary part, but it simply says: "If the object.property 'localStorage.twitterSearch' exists,
		// iterate over it and create readable data out of it. Otherwise, create that object.property using Ajax."

		// I suggest looking at the else-statement below before looking at our intitial if-statement, as it is
		// actually the first step in the process.

		if(localStorage.twitterSearch) {

			// Create the variable 'twitterData' as a parsed version of the string-value 'localStorage.twitterSearch'.
			// Parsing creates objects. 
			var twitterData = JSON.parse(localStorage.twitterSearch);
			// Create an empty array (for iterating over our formatted data later).
			var formattedData = [];

			// Just as the week before, this is our iteration, wherein we'll wrap URLs in an <a> tag. Here it is saying, 
			// "For all properties of the object.property 'twitterData.results', the key will be 'index' and its value will
			// be 'tweet'."
			$.each(twitterData.results, function(index, tweet){ //this robot takes information and saves it correctly

				// Remember, our value 'tweet' is itself an object. By setting a variable to the object.property 'tweet.text'
				// we are accessing the part of the object that is the "text," AKA the tweet itself. 
				var text=tweet.text;

				// if a URL is present, wrap it in an <a> tag
				// -- stuff like "url.url" and "url.expanded_url" refers to keys that call values from the Twitter JSON object
				if(tweet.entities.urls){
					$.each(tweet.entities.urls, function(index, url){
						text=text.replace(url.url, '<a href="' + url.expanded_url + '">' + url.display_url + '</a>');
					})
				}

				// Add (push) the following to the array 'formattedData[]'.
				formattedData.push({
					text: tweet.text,
					from_user_name: tweet.from_user_name
				});

			});
			
			//Create a string version of our array as an object.property of the object 'localStorage'.
			localStorage.formattedData = JSON.stringify(formattedData);
			
			console.log(localStorage.formattedData);

			// Confirm success with a console.logged cry of joy.
			console.log('hooray');
			console.log("this is the raw data: ", twitterData);
			console.log("this is the formatted data: ", formattedData);

		} else {

			$.ajax({

				// our query URL
				url: 'http://search.twitter.com/search.json?q=%22Flower%22%20bitch%20OR%20whore%20OR%20hoe%20OR%20cunt%20OR%20dick%20OR%20stupid%20OR%20jerk&rpp=20&include_entities=true&result_type=mixed',
				
				// our specified data-type
				dataType:'jsonp',

				// If the Ajax was successful, use its 'response' to our query to create 'localStorage.twitterSearch'. Remember, 
				// 'success:function()'' takes an argument, representing the query's response. We can call it whatever we want: 
				// 'response', 'answer', 'stuffWeAskedFor', etc.
				success:function(response){

					// Create 'localStorage.twitterSearch' by turning the response into a string value.
					// This way, we can work with it as text.
					localStorage.twitterSearch = JSON.stringify(response);

					// Console.log "I think that worked," as confirmation that our Ajax was successful. 
					console.log('I think that worked.');
					console.log(response);

				},

				// Send an alert if our Ajax was failed.
				error: function(){
					alert('Error, error: does not compute.');
				}

			})


		}


	</script>

</head>
<body>
	<div id="header-new">
	  <div id="nav-top" role="navigation">
	    <ul id="nav">
	      <li>
	        <a title="Home Page to Giving Tree Website" href="file:///Users/80620/Documents/cooper-union-class/files/index.html">Home</a>
	      </li>
	      <li>
	        <a title="" href="">funfunfun</a>
	      </il>
	      <li>
	        <a title="" href="">Contact</a>
	      </il>
	    </ul>
	  </div>
	</div>
	<div id="stupid" href="http://a4.ec-images.myspacecdn.com/images02/135/476671c4441f4e8fafc402944811974f/l.gif">
	</div>
	<div id="container">
	</div>
</body>
</html>